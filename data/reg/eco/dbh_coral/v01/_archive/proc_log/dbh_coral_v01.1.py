# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-06-16 16:18:03
"""
import arcpy
from arcpy.ia import *

def cold_coral_model():  # cold_coral_model

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    # Check out any necessary licenses.
    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("ImageAnalyst")

    Octocorals_merge_tif = arcpy.Raster("Octocorals_merge.tif")
    geo_abyssal_soft_1km_v01_0_tif = arcpy.Raster("ModelBuilder\\geo_abyssal_soft_1km_v01.0.tif")

    # Process: Project Raster (Project Raster) (management)
    Cold_Octocoral_reproject_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\dbh_coral\\v01\\proc\\Cold_Octocoral_reproject.tif"
    with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", pyramid="PYRAMIDS -1 NEAREST LZ77 75 NO_SKIP NO_SIPS", snapRaster=r"ModelBuilder\grid_1km_v01.1.tif"):
        arcpy.management.ProjectRaster(in_raster=Octocorals_merge_tif, out_raster=Cold_Octocoral_reproject_tif, out_coor_system="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", resampling_type="NEAREST", cell_size="1000 1000", geographic_transform=[], Registration_Point="", in_coor_system="GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]]", vertical="NO_VERTICAL")
        Cold_Octocoral_reproject_tif = arcpy.Raster(Cold_Octocoral_reproject_tif)

    # Process: Focal Statistics (Focal Statistics) (ia)
    octocoral_focal_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\dbh_coral\\v01\\proc\\octocoral_focal.tif"
    Focal_Statistics = octocoral_focal_tif
    with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]"):
        octocoral_focal_tif = arcpy.ia.FocalStatistics(in_raster=Cold_Octocoral_reproject_tif, neighborhood="Wedge 50 0 360 CELL", statistics_type="SUM", ignore_nodata="DATA", percentile_value=90)
        octocoral_focal_tif.save(Focal_Statistics)


    # Process: Extract by Mask (Extract by Mask) (sa)
    Cold_Octocoral_focal_clip_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\dbh_coral\\v01\\proc\\Cold_Octocoral_focal_clip.tif"
    Extract_by_Mask = Cold_Octocoral_focal_clip_tif
    with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask=r"ModelBuilder\geo_abyssal_soft_1km_v01.0.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster=r"ModelBuilder\grid_1km_v01.1.tif"):
        Cold_Octocoral_focal_clip_tif = arcpy.sa.ExtractByMask(in_raster=octocoral_focal_tif, in_mask_data=geo_abyssal_soft_1km_v01_0_tif)
        Cold_Octocoral_focal_clip_tif.save(Extract_by_Mask)


    # Process: Raster Calculator (Raster Calculator) (ia)
    dbh_Cold_coral_v01_1km_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\dbh_coral\\v01\\dbh_Cold_coral_v01_1km.tif"
    Raster_Calculator = dbh_Cold_coral_v01_1km_tif
    with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask=r"ModelBuilder\grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster=r"ModelBuilder\grid_1km_v01.1.tif"):
        dbh_Cold_coral_v01_1km_tif = ((Cold_Octocoral_focal_clip_tif- Cold_Octocoral_focal_clip_tif.minimum)/(Cold_Octocoral_focal_clip_tif.maximum-Cold_Octocoral_focal_clip_tif.minimum))*100
        dbh_Cold_coral_v01_1km_tif.save(Raster_Calculator)


if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"M:\marin\swoc\work\wiosym\data\reg\eco\dbh_coral\v01\proc\dbh_cold_coral\Default.gdb", workspace=r"M:\marin\swoc\work\wiosym\data\reg\eco\dbh_coral\v01\proc\dbh_cold_coral\Default.gdb"):
        cold_coral_model()
