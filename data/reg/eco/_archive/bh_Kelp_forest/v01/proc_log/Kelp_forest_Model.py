# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-06-09 20:09:18
"""
import arcpy
from arcpy.sa import *

def Kelp_forest_Model():  # Kelp_forest_Model

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    # Check out any necessary licenses.
    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("ImageAnalyst")

    # Model Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"M:\marin\swoc\work\wiosym\data\reg\eco\bh_Kelp_forest\v01\proc\kelp_forest\Default.gdb", workspace=r"M:\marin\swoc\work\wiosym\data\reg\eco\bh_Kelp_forest\v01\proc\kelp_forest\Default.gdb"):
        Kelp_UNEP = "Kelp UNEP"
        wiosym_data_bounding_box_v01 = "wiosym_data_bounding_box_v01"
        grid_1km_v01_1_tif = arcpy.Raster("grid_1km_v01.1.tif")
        proc = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\bh_Kelp_forest\\v01\\proc"

        # Process: Intersect (Intersect) (analysis)
        kelp_biome_wio_shp = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\bh_Kelp_forest\\v01\\proc\\kelp_biome_wio.shp"
        with arcpy.EnvManager(outputCoordinateSystem="GEOGCS["GCS_WGS_1984",DATUM["D_WGS84",SPHEROID["WGS84",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]"):
            arcpy.analysis.Intersect(in_features=[[Kelp_UNEP, ""], [wiosym_data_bounding_box_v01, ""]], out_feature_class=kelp_biome_wio_shp, join_attributes="ALL", cluster_tolerance="", output_type="INPUT")

        # Process: Polygon to Raster (Polygon to Raster) (conversion)
        kelp_forest_wio_raster_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\bh_Kelp_forest\\v01\\proc\\kelp_forest_wio_raster.tif"
        arcpy.conversion.PolygonToRaster(in_features=kelp_biome_wio_shp, value_field="gridcode", out_rasterdataset=kelp_forest_wio_raster_tif, cell_assignment="MAXIMUM_COMBINED_AREA", priority_field="NONE", cellsize="0,0001", build_rat="BUILD")

        # Process: Project Raster (Project Raster) (management)
        kelp_forest_wio_raster_proj_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\bh_Kelp_forest\\v01\\proc\\kelp_forest_wio_raster_proj.tif"
        with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", pyramid="PYRAMIDS -1 NEAREST LZ77 75 NO_SKIP NO_SIPS", 
                              snapRaster="grid_1km_v01.1.tif"):
            arcpy.management.ProjectRaster(in_raster=kelp_forest_wio_raster_tif, out_raster=kelp_forest_wio_raster_proj_tif, out_coor_system="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", resampling_type="NEAREST", cell_size="1000 1000", geographic_transform=[], Registration_Point="", in_coor_system="GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS84\",SPHEROID[\"WGS84\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]]", vertical="NO_VERTICAL")
            kelp_forest_wio_raster_proj_tif = arcpy.Raster(kelp_forest_wio_raster_proj_tif)

        # Process: Mosaic To New Raster (Mosaic To New Raster) (management)
        kelp_forest_grid_tif = arcpy.management.MosaicToNewRaster(input_rasters=[kelp_forest_wio_raster_proj_tif, grid_1km_v01_1_tif], output_location=proc, raster_dataset_name_with_extension="kelp_forest_grid.tif", coordinate_system_for_the_raster="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", pixel_type="32_BIT_FLOAT", cellsize=None, number_of_bands=1, mosaic_method="SUM", mosaic_colormap_mode="FIRST")[0]
        kelp_forest_grid_tif = arcpy.Raster(kelp_forest_grid_tif)

        # Process: Raster Calculator (Raster Calculator) (sa)
        kelp_forest_wio_norm_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\bh_Kelp_forest\\v01\\proc\\kelp_forest_wio_norm.tif"
        Raster_Calculator = kelp_forest_wio_norm_tif
        with arcpy.EnvManager(scratchWorkspace=r"M:\marin\swoc\work\wiosym\data\reg\eco\bh_Kelp_forest\v01\proc\kelp_forest\Default.gdb", workspace=r"M:\marin\swoc\work\wiosym\data\reg\eco\bh_Kelp_forest\v01\proc\kelp_forest\Default.gdb"):
            kelp_forest_wio_norm_tif =  (Exp10( kelp_forest_grid_tif ))/10
            kelp_forest_wio_norm_tif.save(Raster_Calculator)


        # Process: Extract by Mask (Extract by Mask) (sa)
        bh_kelp_forest_v_0_1_1_1km_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\eco\\bh_Kelp_forest\\v01\\bh_kelp_forest_v.0.1.1_1km.tif"
        Extract_by_Mask = bh_kelp_forest_v_0_1_1_1km_tif
        with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", cellSizeProjectionMethod="PRESERVE_RESOLUTION", mask="grid_1km_v01.1.tif", 
                              outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", snapRaster="grid_1km_v01.1.tif"):
            bh_kelp_forest_v_0_1_1_1km_tif = arcpy.sa.ExtractByMask(in_raster=kelp_forest_wio_norm_tif, in_mask_data=grid_1km_v01_1_tif)
            bh_kelp_forest_v_0_1_1_1km_tif.save(Extract_by_Mask)


if __name__ == '__main__':
    Kelp_forest_Model()
