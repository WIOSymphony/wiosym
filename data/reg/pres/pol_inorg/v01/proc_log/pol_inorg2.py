# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-09-08 01:59:26
"""
import arcpy
from arcpy.ia import *

def pol_inorg2():  # pol_inorg2

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    # Check out any necessary licenses.
    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("ImageAnalyst")

    # Model Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\pol_inorg\v01\proc\pol_inorganic\Default.gdb", workspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\pol_inorg\v01\proc\pol_inorganic\Default.gdb"):
        TSIP_inorganic_toxin = "TSIP_inorganic_toxin"
        grid_1km_v01_1_tif = "1000 1000"
        pol_inorganic = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\pol_inorg\\v01\\proc\\pol_inorganic"

        # Process: Buffer (Buffer) (analysis)
        TSIP_inorganic_toxin_Buffer = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\pol_inorg\\v01\\proc\\pol_inorganic\\Default.gdb\\TSIP_inorganic_toxin_Buffer"
        with arcpy.EnvManager(outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", scratchWorkspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\pol_inorg\v01\proc\pol_inorganic\Default.gdb", workspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\pol_inorg\v01\proc\pol_inorganic\Default.gdb"):
            arcpy.analysis.Buffer(in_features=TSIP_inorganic_toxin, out_feature_class=TSIP_inorganic_toxin_Buffer, buffer_distance_or_field="3 Kilometers", line_side="FULL", line_end_type="ROUND", dissolve_option="ALL", dissolve_field=[], method="PLANAR")

        # Process: Polygon to Raster (Polygon to Raster) (conversion)
        inorganic_bs_value_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\pol_inorg\\v01\\proc\\pol_inorganic\\inorganic_bs_value.tif"
        with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", snapRaster="grid_1km_v01.1.tif"):
            arcpy.conversion.PolygonToRaster(in_features=TSIP_inorganic_toxin_Buffer, value_field="OBJECTID", out_rasterdataset=inorganic_bs_value_tif, cell_assignment="CELL_CENTER", priority_field="NONE", cellsize="M:\\marin\\swoc\\work\\wiosym\\data\\reg\\grid\\grid\\v01\\grid_1km_v01.1.tif", build_rat="BUILD")

        # Process: Focal Statistics (Focal Statistics) (ia)
        inorganic_focal_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\pol_inorg\\v01\\proc\\pol_inorganic\\inorganic_focal.tif"
        Focal_Statistics = inorganic_focal_tif
        with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                              snapRaster="grid_1km_v01.1.tif"):
            inorganic_focal_tif = arcpy.ia.FocalStatistics(in_raster=inorganic_bs_value_tif, neighborhood="Circle 3 CELL", statistics_type="VARIETY", ignore_nodata="DATA", percentile_value=90)
            inorganic_focal_tif.save(Focal_Statistics)


        # Process: Raster Calculator (Raster Calculator) (ia)
        grid_0proxy_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\pol_inorg\\v01\\proc\\pol_inorganic\\grid_0proxy.tif"
        Raster_Calculator = grid_0proxy_tif
        with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask=r"ModelBuilder\grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                              snapRaster=r"ModelBuilder\grid_1km_v01.1.tif"):
            grid_0proxy_tif =  grid_1km_v01_1_tif *0
            grid_0proxy_tif.save(Raster_Calculator)


        # Process: Mosaic To New Raster (Mosaic To New Raster) (management)
        inorganic_polv2_tif = arcpy.management.MosaicToNewRaster(input_rasters=[inorganic_focal_tif, grid_0proxy_tif], output_location=pol_inorganic, raster_dataset_name_with_extension="inorganic_polv2.tif", coordinate_system_for_the_raster="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", pixel_type="32_BIT_FLOAT", cellsize=None, number_of_bands=1, mosaic_method="SUM", mosaic_colormap_mode="FIRST")[0]
        inorganic_polv2_tif = arcpy.Raster(inorganic_polv2_tif)

        # Process: Resample (2) (Resample) (management)
        pol_inorganic_v2_1km_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\pol_inorg\\v01\\pol_inorganic_v2_1km.tif"
        with arcpy.EnvManager(outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", snapRaster=r"ModelBuilder\grid_1km_v01.1.tif"):
            arcpy.management.Resample(in_raster=inorganic_polv2_tif, out_raster=pol_inorganic_v2_1km_tif, cell_size="1000 1000", resampling_type="NEAREST")
            pol_inorganic_v2_1km_tif = arcpy.Raster(pol_inorganic_v2_1km_tif)

if __name__ == '__main__':
    pol_inorg2()
