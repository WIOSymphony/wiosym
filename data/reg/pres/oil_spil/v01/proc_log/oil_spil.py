# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-06-19 15:59:53
"""
import arcpy
from arcpy.ia import *
from arcpy.ia import *
from arcpy.ia import *
from arcpy.ia import *
from arcpy.ia import *
from arcpy.ia import *
from arcpy.ia import *
from arcpy.sa import *
from arcpy.sa import *
from sys import argv

def Model1(oil_spil_potential_relative_current_tif="M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\oil_spil_potential_relative_current.tif"):  # oil_spil.tif

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    # Check out any necessary licenses.
    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("ImageAnalyst")

    v1_total_mean_velocity_norm_int_tif = arcpy.Raster("v1_total_mean_velocity_norm_int.tif")
    grid_1km_v01_1_tif = arcpy.Raster("grid_1km_v01.1.tif")
    commer_extract_mask_tif = arcpy.Raster("commer_extract_mask.tif")
    oilgas_extract_mask_tif = arcpy.Raster("oilgas_extract_mask.tif")
    ship_fishing_mask_tif = arcpy.Raster("ship_fishing_mask.tif")
    proc = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc"

    # Process: Focal Statistics (3) (Focal Statistics) (ia)
    current_effect_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\current_effect.tif"
    Focal_Statistics_3_ = current_effect_tif
    with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster="grid_1km_v01.1.tif"):
        current_effect_tif = arcpy.ia.FocalStatistics(in_raster=v1_total_mean_velocity_norm_int_tif, neighborhood="Wedge 10 0 360 CELL", statistics_type="SUM", ignore_nodata="DATA", percentile_value=90)
        current_effect_tif.save(Focal_Statistics_3_)


    # Process: Raster Calculator (7) (Raster Calculator) (ia)
    current_effect_norm_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\current_effect_norm.tif"
    Raster_Calculator_7_ = current_effect_norm_tif
    with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster="grid_1km_v01.1.tif"):
        current_effect_norm_tif =  ((current_effect_tif -current_effect_tif.minimum)/(current_effect_tif.maximum-current_effect_tif.minimum))*100
        current_effect_norm_tif.save(Raster_Calculator_7_)


    # Process: Raster Calculator (2) (Raster Calculator) (ia)
    commersial_shipping_0_1_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\commersial_shipping_0-1.tif"
    Raster_Calculator_2_ = commersial_shipping_0_1_tif
    commersial_shipping_0_1_tif =  ((commer_extract_mask_tif -commer_extract_mask_tif.minimum)/( commer_extract_mask_tif.maximum-commer_extract_mask_tif.minimum))*1
    commersial_shipping_0_1_tif.save(Raster_Calculator_2_)


    # Process: Raster Calculator (Raster Calculator) (ia)
    Oil_gas_shipping_withingrid_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\Oil_gas_shipping_withingrid.tif"
    Raster_Calculator = Oil_gas_shipping_withingrid_tif
    Oil_gas_shipping_withingrid_tif =  oilgas_extract_mask_tif *(-1)
    Oil_gas_shipping_withingrid_tif.save(Raster_Calculator)


    # Process: Raster Calculator (3) (Raster Calculator) (ia)
    oil_gas_shipping_0_1_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\oil_gas_shipping_0-1.tif"
    Raster_Calculator_3_ = oil_gas_shipping_0_1_tif
    oil_gas_shipping_0_1_tif =  ((Oil_gas_shipping_withingrid_tif -Oil_gas_shipping_withingrid_tif.minimum)/(Oil_gas_shipping_withingrid_tif.maximum- Oil_gas_shipping_withingrid_tif.minimum))*1
    oil_gas_shipping_0_1_tif.save(Raster_Calculator_3_)


    # Process: Focal Statistics (Focal Statistics) (ia)
    fishing_focal_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\fishing_focal.tif"
    Focal_Statistics = fishing_focal_tif
    fishing_focal_tif = arcpy.ia.FocalStatistics(in_raster=ship_fishing_mask_tif, neighborhood="Wedge 5 0 360 CELL", statistics_type="MAJORITY", ignore_nodata="DATA", percentile_value=90)
    fishing_focal_tif.save(Focal_Statistics)


    # Process: Raster Calculator (4) (Raster Calculator) (ia)
    fishing_0_1_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\fishing_0-1.tif"
    Raster_Calculator_4_ = fishing_0_1_tif
    fishing_0_1_tif =  (((fishing_focal_tif -fishing_focal_tif.minimum)/ (fishing_focal_tif.maximum- fishing_focal_tif.minimum))*1)+1
    fishing_0_1_tif.save(Raster_Calculator_4_)


    # Process: Mosaic To New Raster (Mosaic To New Raster) (management)
    with arcpy.EnvManager(pyramid="PYRAMIDS -1 NEAREST LZ77 75 NO_SKIP NO_SIPS"):
        fishing_combine_grid_tif = arcpy.management.MosaicToNewRaster(input_rasters=[fishing_0_1_tif, grid_1km_v01_1_tif], output_location=proc, raster_dataset_name_with_extension="fishing_combine_grid.tif", coordinate_system_for_the_raster="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", pixel_type="32_BIT_FLOAT", cellsize=None, number_of_bands=1, mosaic_method="SUM", mosaic_colormap_mode="FIRST")[0]
        fishing_combine_grid_tif = arcpy.Raster(fishing_combine_grid_tif)

    # Process: Raster Calculator (5) (Raster Calculator) (ia)
    fishing_0_1_norm_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\fishing_0-1_norm.tif"
    Raster_Calculator_5_ = fishing_0_1_norm_tif
    fishing_0_1_norm_tif =  ((fishing_combine_grid_tif -fishing_combine_grid_tif.minimum)/(fishing_combine_grid_tif.maximum- fishing_combine_grid_tif.minimum))*1
    fishing_0_1_norm_tif.save(Raster_Calculator_5_)


    # Process: Weighted Sum (Weighted Sum) (ia)
    oil_spil_potential_weight_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\oil_spil_potential_weight.tif"
    Weighted_Sum = oil_spil_potential_weight_tif
    oil_spil_potential_weight_tif = arcpy.ia.WeightedSum(in_rasters=[[commersial_shipping_0_1_tif, "VALUE", 20], [oil_gas_shipping_0_1_tif, "VALUE", 60], [fishing_0_1_norm_tif, "VALUE", 20]])
    oil_spil_potential_weight_tif.save(Weighted_Sum)


    # Process: Focal Statistics (2) (Focal Statistics) (ia)
    oil_spil_potential_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\oil_spil_potential.tif"
    Focal_Statistics_2_ = oil_spil_potential_tif
    oil_spil_potential_tif = arcpy.ia.FocalStatistics(in_raster=oil_spil_potential_weight_tif, neighborhood="Wedge 50 0 360 CELL", statistics_type="SUM", ignore_nodata="DATA", percentile_value=90)
    oil_spil_potential_tif.save(Focal_Statistics_2_)


    # Process: Raster Calculator (6) (Raster Calculator) (ia)
    oil_spil_potential_1_100_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\oil_spil_potential_1-100.tif"
    Raster_Calculator_6_ = oil_spil_potential_1_100_tif
    with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster="grid_1km_v01.1.tif"):
        oil_spil_potential_1_100_tif =  ((oil_spil_potential_tif- oil_spil_potential_tif.minimum)/( oil_spil_potential_tif.maximum- oil_spil_potential_tif.minimum))*100
        oil_spil_potential_1_100_tif.save(Raster_Calculator_6_)


    # Process: Weighted Sum (2) (Weighted Sum) (ia)
    Weighted_Sum_2_ = oil_spil_potential_relative_current_tif
    with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster="grid_1km_v01.1.tif"):
        oil_spil_potential_relative_current_tif = arcpy.ia.WeightedSum(in_rasters=[[oil_spil_potential_1_100_tif, "VALUE", 50], [v1_total_mean_velocity_norm_int_tif, "Value", 50]])
        oil_spil_potential_relative_current_tif.save(Weighted_Sum_2_)


    # Process: Raster Calculator (8) (Raster Calculator) (sa)
    oil_spil_norm_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\proc\\oil_spil_norm.tif"
    Raster_Calculator_8_ = oil_spil_norm_tif
    with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster="grid_1km_v01.1.tif"):
        oil_spil_norm_tif =  ((oil_spil_potential_relative_current_tif - oil_spil_potential_relative_current_tif.minimum)/(oil_spil_potential_relative_current_tif.maximum- oil_spil_potential_relative_current_tif.minimum))*100
        oil_spil_norm_tif.save(Raster_Calculator_8_)


    # Process: Mosaic To New Raster (2) (Mosaic To New Raster) (management)
    with arcpy.EnvManager(pyramid="PYRAMIDS -1 NEAREST LZ77 75 NO_SKIP NO_SIPS"):
        oil_spil_mosiac_tif = arcpy.management.MosaicToNewRaster(input_rasters=[grid_1km_v01_1_tif, oil_spil_norm_tif], output_location=proc, raster_dataset_name_with_extension="oil_spil_mosiac.tif", coordinate_system_for_the_raster="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", pixel_type="32_BIT_FLOAT", cellsize=None, number_of_bands=1, mosaic_method="SUM", mosaic_colormap_mode="FIRST")[0]
        oil_spil_mosiac_tif = arcpy.Raster(oil_spil_mosiac_tif)

    # Process: Raster Calculator (9) (Raster Calculator) (sa)
    oil_spill_shiping_relative_1km_v_0_1_0_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\oil_spil\\v01\\oil_spill_shiping_relative_1km_v.0.1.0.tif"
    Raster_Calculator_9_ = oil_spill_shiping_relative_1km_v_0_1_0_tif
    with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                          snapRaster="grid_1km_v01.1.tif"):
        oil_spill_shiping_relative_1km_v_0_1_0_tif =  ((oil_spil_mosiac_tif- oil_spil_mosiac_tif.minimum)/(oil_spil_mosiac_tif.maximum- oil_spil_mosiac_tif.minimum))*100
        oil_spill_shiping_relative_1km_v_0_1_0_tif.save(Raster_Calculator_9_)


if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\oil_spil\Default.gdb", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\oil_spil\Default.gdb"):
        Model1(*argv[1:])
