# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-06-19 17:30:59
"""
import arcpy
from arcpy.ia import *
from arcpy.ia import *
from arcpy.sa import *

def ports_model():  # ports_model

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    # Check out any necessary licenses.
    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("ImageAnalyst")

    # Model Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
        TSM_0000000000_0000046592_tif = arcpy.Raster("TSM-0000000000-0000046592.tif")
        TSM_0000000000_0000023296_tif = arcpy.Raster("TSM-0000000000-0000023296.tif")
        proc = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc"
        wld_trs_ports_wfp = "wld_trs_ports_wfp"
        wiosym_data_bounding_box_v01 = "wiosym_data_bounding_box_v01"
        grid_1km_v01_1_tif = arcpy.Raster("grid_1km_v01.1.tif")
        proc_2_ = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc"

        # Process: Mosaic To New Raster (Mosaic To New Raster) (management)
        with arcpy.EnvManager(nodata="MAP_UP", scratchWorkspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", workspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            TSM_mosaic_mg_l_tif = arcpy.management.MosaicToNewRaster(input_rasters=[TSM_0000000000_0000046592_tif, TSM_0000000000_0000023296_tif], output_location=proc, raster_dataset_name_with_extension="TSM_mosaic_mg_l.tif", coordinate_system_for_the_raster="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", pixel_type="64_BIT", cellsize=None, number_of_bands=1, mosaic_method="LAST", mosaic_colormap_mode="FIRST")[0]
            TSM_mosaic_mg_l_tif = arcpy.Raster(TSM_mosaic_mg_l_tif)

        # Process: Project Raster (Project Raster) (management)
        TSMmosiac_project_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\TSMmosiac_project.tif"
        with arcpy.EnvManager(cellSize=r"M:\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", nodata="MAP_DOWN", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                              snapRaster="grid_1km_v01.1.tif"):
            arcpy.management.ProjectRaster(in_raster=TSM_mosaic_mg_l_tif, out_raster=TSMmosiac_project_tif, out_coor_system="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", resampling_type="NEAREST", cell_size="1000 1000", geographic_transform=[], Registration_Point="", in_coor_system="", vertical="NO_VERTICAL")
            TSMmosiac_project_tif = arcpy.Raster(TSMmosiac_project_tif)

        # Process: Buffer (Buffer) (analysis)
        Port_buffer20km_shp = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\Port_buffer20km.shp"
        with arcpy.EnvManager(scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            arcpy.analysis.Buffer(in_features=wld_trs_ports_wfp, out_feature_class=Port_buffer20km_shp, buffer_distance_or_field="50 Kilometers", line_side="FULL", line_end_type="ROUND", dissolve_option="ALL", dissolve_field=[], method="PLANAR")

        # Process: Clip (Clip) (analysis)
        Port_buffer20km_clip_shp = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\Port_buffer20km_clip.shp"
        with arcpy.EnvManager(scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            arcpy.analysis.Clip(in_features=Port_buffer20km_shp, clip_features=wiosym_data_bounding_box_v01, out_feature_class=Port_buffer20km_clip_shp, cluster_tolerance="")

        # Process: Polygon to Raster (Polygon to Raster) (conversion)
        port_raster_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\port_raster.tif"
        with arcpy.EnvManager(scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            arcpy.conversion.PolygonToRaster(in_features=Port_buffer20km_clip_shp, value_field="FID", out_rasterdataset=port_raster_tif, cell_assignment="MAXIMUM_COMBINED_AREA", priority_field="NONE", cellsize="0,01", build_rat="BUILD")

        # Process: Extract by Mask (Extract by Mask) (sa)
        TSM_buffer_mask_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\TSM_buffer_mask.tif"
        Extract_by_Mask = TSM_buffer_mask_tif
        with arcpy.EnvManager(scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            TSM_buffer_mask_tif = arcpy.sa.ExtractByMask(in_raster=TSMmosiac_project_tif, in_mask_data=port_raster_tif)
            TSM_buffer_mask_tif.save(Extract_by_Mask)


        # Process: Extract by Mask (2) (Extract by Mask) (sa)
        TSM_mask_grid_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\TSM_mask_grid.tif"
        Extract_by_Mask_2_ = TSM_mask_grid_tif
        with arcpy.EnvManager(mask="grid_1km_v01.1.tif", scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", snapRaster="grid_1km_v01.1.tif", 
                              workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            TSM_mask_grid_tif = arcpy.sa.ExtractByMask(in_raster=TSM_buffer_mask_tif, in_mask_data=grid_1km_v01_1_tif)
            TSM_mask_grid_tif.save(Extract_by_Mask_2_)


        # Process: Raster Calculator (Raster Calculator) (sa)
        TSM_port_reverse_value_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\TSM_port_reverse_value.tif"
        Raster_Calculator = TSM_port_reverse_value_tif
        with arcpy.EnvManager(scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            TSM_port_reverse_value_tif =  TSM_mask_grid_tif *(-1)
            TSM_port_reverse_value_tif.save(Raster_Calculator)


        # Process: Resample (Resample) (management)
        ports_turbid1_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\ports_turbid1.tif"
        with arcpy.EnvManager(outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", snapRaster="grid_1km_v01.1.tif", 
                              workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            arcpy.management.Resample(in_raster=TSM_port_reverse_value_tif, out_raster=ports_turbid1_tif, cell_size="1043,11263740664 1043,11263740664", resampling_type="NEAREST")
            ports_turbid1_tif = arcpy.Raster(ports_turbid1_tif)

        # Process: Focal Statistics (Focal Statistics) (sa)
        ports_turbid_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\ports_turbid.tif"
        Focal_Statistics = ports_turbid_tif
        ports_turbid_tif = arcpy.sa.FocalStatistics(in_raster=ports_turbid1_tif, neighborhood="Wedge 30 0 360 CELL", statistics_type="SUM", ignore_nodata="DATA", percentile_value=90)
        ports_turbid_tif.save(Focal_Statistics)


        # Process: Raster Calculator (2) (Raster Calculator) (ia)
        port_norm_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\proc\\port_norm.tif"
        Raster_Calculator_2_ = port_norm_tif
        with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                              scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", snapRaster="grid_1km_v01.1.tif", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            port_norm_tif =  ((ports_turbid_tif- ports_turbid_tif.minimum)/ (ports_turbid_tif.maximum - ports_turbid_tif.minimum))*100
            port_norm_tif.save(Raster_Calculator_2_)


        # Process: Mosaic To New Raster (2) (Mosaic To New Raster) (management)
        with arcpy.EnvManager(pyramid="PYRAMIDS -1 NEAREST LZ77 75 NO_SKIP NO_SIPS"):
            port_norm_combine_grid_tif = arcpy.management.MosaicToNewRaster(input_rasters=[port_norm_tif, grid_1km_v01_1_tif], output_location=proc_2_, raster_dataset_name_with_extension="port_norm_combine_grid.tif", coordinate_system_for_the_raster="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", pixel_type="8_BIT_UNSIGNED", cellsize=None, number_of_bands=1, mosaic_method="SUM", mosaic_colormap_mode="FIRST")[0]
            port_norm_combine_grid_tif = arcpy.Raster(port_norm_combine_grid_tif)

        # Process: Raster Calculator (3) (Raster Calculator) (ia)
        ports_v0_1_0_1_km_tif = "M:\\proj\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\ports\\v01\\ports_v0.1.0_1_km.tif"
        Raster_Calculator_3_ = ports_v0_1_0_1_km_tif
        with arcpy.EnvManager(cellSize=r"M:\proj\marin\swoc\work\wiosym\data\reg\grid\grid\v01\grid_1km_v01.1.tif", mask="grid_1km_v01.1.tif", outputCoordinateSystem="PROJCS["WGS_1984_Cylindrical_Equal_Area",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Cylindrical_Equal_Area"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",12.0],PARAMETER["standard_parallel_1",-12.0],UNIT["Meter",1.0]]", 
                              scratchWorkspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb", snapRaster="grid_1km_v01.1.tif", workspace=r"M:\proj\marin\swoc\work\wiosym\data\reg\pres\ports\v01\proc\ports\Default.gdb"):
            ports_v0_1_0_1_km_tif =  ((port_norm_combine_grid_tif- port_norm_combine_grid_tif.minimum)/(port_norm_combine_grid_tif.maximum- port_norm_combine_grid_tif.minimum))*100
            ports_v0_1_0_1_km_tif.save(Raster_Calculator_3_)


if __name__ == '__main__':
    ports_model()
