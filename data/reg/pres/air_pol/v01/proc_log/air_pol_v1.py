# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-05-12 14:30:53
"""
import arcpy
from arcpy.ia import *
from arcpy.ia import *
from arcpy.ia import *
from arcpy.ia import *

def air_pol_v1():  # air_pol_v1

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    # Check out any necessary licenses.
    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("ImageAnalyst")

    # Model Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\air_pol\v01\proc\air_pol\air_pol.gdb", workspace=r"M:\marin\swoc\work\wiosym\data\reg\pres\air_pol\v01\proc\air_pol\air_pol.gdb"):
        SO2_wio21_tif = arcpy.Raster("SO2_wio21.tif")
        NO2_wio_tif = arcpy.Raster("NO2_wio.tif")
        CO_wio21_1km_tif_2_ = arcpy.Raster("CO_wio21_1km.tif")
        grid_1km_v01_1_tif = arcpy.Raster("grid_1km_v01.1.tif")
        grid_1km_na_v01_1_tif = arcpy.Raster("grid_1km_na_v01.1.tif")
        Pollution_combine_mask_tif_Pollution_combine_mask_tif = arcpy.Raster("ModelBuilder\\Pollution_combine_mask.tif:Pollution_combine_mask.tif")
        Pollution_combine_2021_tif_Pollution_combine_2021_tif = arcpy.Raster("ModelBuilder\\Pollution_combine_2021.tif:Pollution_combine_2021.tif")

        # Process: Raster Calculator (3) (Raster Calculator) (ia)
        combine_airpol_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\air_pol\\v01\\proc\\combine_airpol.tif"
        Raster_Calculator_3_ = combine_airpol_tif
        combine_airpol_tif =  SO2_wio21_tif + NO2_wio_tif + CO_wio21_1km_tif_2_
        combine_airpol_tif.save(Raster_Calculator_3_)


        # Process: Project Raster (3) (Project Raster) (management)
        combine_airpol_project1 = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\air_pol\\v01\\proc\\air_pol\\air_pol.gdb\\combine_airpol_project1"
        arcpy.management.ProjectRaster(in_raster=combine_airpol_tif, out_raster=combine_airpol_project1, out_coor_system="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", resampling_type="NEAREST", cell_size="1000 1000", geographic_transform=[], Registration_Point="", in_coor_system="PROJCS[\"WGS_1984_Cylindrical_Equal_Area\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Cylindrical_Equal_Area\"],PARAMETER[\"false_easting\",0.0],PARAMETER[\"false_northing\",0.0],PARAMETER[\"central_meridian\",12.0],PARAMETER[\"standard_parallel_1\",-12.0],UNIT[\"Meter\",1.0]]", vertical="NO_VERTICAL")
        combine_airpol_project1 = arcpy.Raster(combine_airpol_project1)

        # Process: Focal Statistics (Focal Statistics) (ia)
        Pol_combine_focal_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\air_pol\\v01\\proc\\Pol_combine_focal.tif"
        Focal_Statistics = Pol_combine_focal_tif
        Pol_combine_focal_tif = arcpy.ia.FocalStatistics(in_raster=combine_airpol_project1, neighborhood="Circle 100 CELL", statistics_type="SUM", ignore_nodata="NODATA", percentile_value=90)
        Pol_combine_focal_tif.save(Focal_Statistics)


        # Process: Extract by Mask (Extract by Mask) (sa)
        Pollution_combine_mask_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\air_pol\\v01\\proc\\Pollution_combine_mask.tif"
        Extract_by_Mask = Pollution_combine_mask_tif
        Pollution_combine_mask_tif = arcpy.sa.ExtractByMask(in_raster=Pol_combine_focal_tif, in_mask_data=grid_1km_v01_1_tif)
        Pollution_combine_mask_tif.save(Extract_by_Mask)


        # Process: Raster Calculator (6) (Raster Calculator) (ia)
        NO2_SetNull_log_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\air_pol\\v01\\proc\\NO2_SetNull_log.tif"
        Raster_Calculator_6_ = NO2_SetNull_log_tif
        NO2_SetNull_log_tif = Log10("%NO2_SetNull_ProjectRaster%")
        NO2_SetNull_log_tif.save(Raster_Calculator_6_)


        # Process: Raster Calculator (Raster Calculator) (ia)
        Pollution_combine_2021_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\air_pol\\v01\\proc\\Pollution_combine_2021.tif"
        Raster_Calculator = Pollution_combine_2021_tif
        Pollution_combine_2021_tif = Log10(Pollution_combine_mask_tif_Pollution_combine_mask_tif)
        Pollution_combine_2021_tif.save(Raster_Calculator)


        # Process: Raster Calculator (2) (Raster Calculator) (ia)
        Air_pol_norm_v01_0_tif = "M:\\marin\\swoc\\work\\wiosym\\data\\reg\\pres\\air_pol\\v01\\Air_pol_norm_v01.0_.tif"
        Raster_Calculator_2_ = Air_pol_norm_v01_0_tif
        Air_pol_norm_v01_0_tif =  (Pollution_combine_2021_tif- Pollution_combine_2021_tif.minimum)/(Pollution_combine_2021_tif_Pollution_combine_2021_tif.maximum - Pollution_combine_2021_tif_Pollution_combine_2021_tif.minimum)*100
        Air_pol_norm_v01_0_tif.save(Raster_Calculator_2_)


if __name__ == '__main__':
    air_pol_v1()
